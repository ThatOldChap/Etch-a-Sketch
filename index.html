<!DOCTYPE html>
<!-- Developed by Michael Chaplin -->
<!-- April 20th, 2020 -->
<head>
    <meta charset="utf-8"/>
</head>
<style>
    body, html {
        height: 100%;
        width: 100%;
        padding: 0 0 0 0;
        margin: 0 0 0 0;
        background-color: #121212;
    }
    #content {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
    }
    #header-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 20px;
    }
    #title {
        color: white;
        padding: 0 0 0 0;
        margin: 0 0 0 0;
    }
    #signature {
        color: white;
        padding: 0 0 0 0;
        margin: 0 0 1rem 0;
    }
    #sketch-frame {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100%;
        width: 100%;
    }
    #sketch-header {
        display: flex;
        width: 600px;
        flex-direction: row;
        align-content: stretch;
        align-items: center;
    }
    #sketch-container {
        display: flex;
        flex-direction: column;
        width: 600px;
        height: 600px;
        border: #FFFFFF solid 2px;
    }
    .grid-row {
        flex: 0 1 100%;
        display: flex;
        flex-direction: row;
    }
    .grid-item {
        flex: 0 1 100%;
        border: #181818 solid 0.5px;
    }
    #grid-size, #reset-button, #color-list {
        flex: 0 1 100%;
    }
    #grid-size {
        color: #FFFFFF;
        font-size: 1rem;
        margin: 0 0 0.5rem 0;
        padding: 0 0 0 0;
        display: flex;
        align-self: flex-end;
    }
    #reset-button {
        margin: 0 0 0.5rem 0;
        font-size: 1.25rem;
        width: max-content;
        background-color: #232323;
        border-color: #565656;
        color: #FFFFFF;
        opacity: 0.6;
    }
    #color-list {
        display: flex;
        flex-direction: row;
        justify-content: right;
        align-items: center;
    }
    .color-picker {
        width: 20px;
        height: 20px;
        border: #565656 solid 2px;
        margin: 5px;
    }
    .color-picker:hover {
        width: 25px;
        height: 25px;
    }
    #multi {
        background: linear-gradient(to left, #ff3300 0%, #00ffff 100%);
    }
    #white {
        background-color: #FFFFFF;
    }
    #red {
        background-color: #DB4437;
    }
    #yellow {
        background-color: #F4B400;
    }
</style>

<html>
    <body>
        <div id='content'>
            <div id='header-container'>
                <h1 id='title'>Etch-a-Sketch</h1>
                <h6 id='signature'>By: Michael Chaplin</h6>
            </div>
            <div id='sketch-frame'>
                <div id='sketch-header'>
                    <h3 id='grid-size'>Grid Size: </h3>
                    <button id='reset-button'>Clear Grid</button>
                    <div id='color-list'>
                        <div id='multi' class='color-picker'></div>
                        <div id='white' class='color-picker'></div>
                        <div id='red' class='color-picker'></div>
                        <div id='yellow' class='color-picker'></div>
                    </div>
                </div>
                <div id='sketch-container'></div>
            </div>
        </div>
    </body>
    <script>


        const colorPickers = document.getElementsByClassName('color-picker');

        // Creates the grid with the square elements
        const gridContainer = document.querySelector('#sketch-container');
        let gridSize;
        let selectedColorID;
        let selectedColor;
        let selectedGridItem;
        initGrid();

        function initGrid () {
            gridSize = 16;
            selectedColorID = 'white';
            selectedColor = '#FFFFFF';
            createGrid(gridSize);
        }

        const resetButton = document.querySelector('#reset-button');
        resetButton.addEventListener('click', function resetGrid() {
            
            // Asks the user for a valid grid size to reset to
            while (true) {
                gridSize = prompt("Please enter desired grid size:");

                if(gridSize == null) {
                    console.log(`User clicked cancel. gridSize = ${gridSize}`);
                    return false;

                } else if(isNaN(gridSize) || gridSize.length <= 0 || gridSize < 1) {
                    alert("Invalid input. Please enter a valid number");
                    console.log(`Invalid input of: ${gridSize}`);

                } else {
                    // Clears the grid of all DOM elements from previous grid
                    while (gridContainer.firstChild) {
                        gridContainer.removeChild(gridContainer.lastChild);
                    }
                    parseInt(gridSize);
                    console.log(`Changing grid size to ${gridSize}`);
                    createGrid(gridSize);
                    break;
                }
            }
        });

        function createGrid (gridSize) {
            for (i = 0; i < gridSize; i++) {
                const gridRow = document.createElement('div');
                gridRow.className = 'grid-row';
            
                for (j = 0; j < gridSize; j++) {
                    const gridItem = document.createElement('div');
                    gridItem.className = 'grid-item';
                    gridRow.appendChild(gridItem);
                    gridItem.id = `${i}${j}`;

                    gridItem.addEventListener("mouseover", function changeColor() {
                        if(selectedColorID == 'multi'){
                            if(gridItem.style.opacity.length > 0){
                                opacity = Number(gridItem.style.opacity);
                                (opacity > 0) ? (opacity -= 0.1) : opacity = 0;
                                gridItem.style.opacity = `${opacity}`;
                            } else {
                                gridItem.style.backgroundColor = `${randColor()}`;
                                gridItem.style.opacity = `1`;
                            }
                        } else {
                            gridItem.style.backgroundColor = selectedColor;
                            gridItem.style.opacity = '1';
                            console.log(`Color is ${selectedColor}`);
                        }
                    });
                }
                gridContainer.appendChild(gridRow);
            }
        }
    
        function randColor() {
            return `hsl(${Math.floor(Math.random()*360)}, 100%, 50%)`;
        }

        for (let i = 0; i < colorPickers.length; i++) {
            colorPickers[i].addEventListener('click', (event) => {
                selectedColorID = event.target.id;
                switch (selectedColorID) {
                    case 'multi':
                        selectedColor = 'multi';
                        break;
                    case 'white':
                        selectedColor = '#FFFFFF';
                        break;
                    case 'red':
                        selectedColor = '#DB4437';
                        break;
                    case 'yellow':
                        selectedColor = '#F4B400';
                        break;
                    default:
                        selectedColor = '#252525';
                        console.log(`selectedColorID is invalid and = ${selectedColorID}`);
                        break;
                }
                console.log(`Selected color = ${selectedColorID}`);
                changeEtchColor(selectedColor);
            });
        }

        function changeEtchColor(color) {
            selectedColor = color;
        }
    </script>
</html>